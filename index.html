<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Games Planet Order Form ‚Äî v2.2</title>
<style>
  body{margin:0;font-family:Arial, sans-serif;background:#0b1020;color:#eaf1ff;padding-bottom:120px}
  header{text-align:center;padding:18px}
  h1{margin:0 0 4px} h2{margin:0;font-weight:500;color:#9fb0d3}
  main{max-width:900px;margin:auto;padding:10px}
  .card{background:#121a33;border:1px solid #1e2751;border-radius:12px;padding:14px;margin:10px 0}
  label{display:block;font-size:13px;color:#9fb0d3;margin-bottom:4px}
  input,select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #2a335a;background:#0f1530;color:#eaf1ff;font-size:15px}
  input[readonly]{opacity:.85}
  .summary{font-family:monospace;background:#0f1530;border-radius:8px;padding:10px;border:1px dashed #2a335a;white-space:pre-line}
  .actions{position:fixed;left:0;right:0;bottom:0;background:rgba(11,16,32,.95);padding:12px}
  .actions-inner{max-width:900px;margin:auto;display:flex;gap:10px;justify-content:center}
  button{padding:12px 18px;font-size:17px;border:none;border-radius:8px;cursor:pointer;box-shadow:0 5px 15px rgba(0,0,0,.3)}
  .btn-pay{background:#00b9f5;color:#fff}
  .btn-send{background:#28a745;color:#fff}
  .btn-send[disabled]{opacity:.6;cursor:not-allowed}
</style>
</head>
<body>
<header>
  <h1>GAMES PLANET</h1>
  <h2>Manual Order Page ‚Äî v2.2</h2>
</header>

<main>
  <div class="card">
    <h3>Customer Details</h3>
    <label>Name</label><input id="name">
    <label>Mobile</label><input id="mobile" maxlength="10">
    <label>Alt Mobile</label><input id="altmobile" maxlength="10">
    <label>Email</label><input id="email" type="email">
    <label>Address</label><textarea id="address"></textarea>
    <label>Landmark</label><input id="landmark">
    <label>Pincode</label><input id="pincode" maxlength="6">
    <div id="deliveryEstimate" class="summary"></div>
    <label>State</label><input id="state" readonly>
    <label>District/City</label><input id="city" readonly>
    <label>Post Office</label>
    <select id="postoffice"><option value="">Select</option></select>
  </div>

  <div class="card">
    <h3>Order Details</h3>
    <label>Product</label><input id="product">
    <label>Variant</label><input id="variant">

    <label>Add-on Name</label><input id="addonName">
    <label>Add-on Amount (‚Çπ)</label><input id="addonAmount" type="number" min="0">

    <label>Courier</label>
    <select id="courier"><option>Delhivery</option><option>DTDC</option><option>Speed Post</option></select>

    <label>Payment Mode</label>
    <select id="paymentmode">
      <option value="prepaid">Prepaid</option>
      <option value="cod">Cash on Delivery</option>
    </select>
    <div id="codEligibilityNote" style="font-size:13px;color:#ffd54f"></div>

    <label>Coupon (Prepaid ke liye Coupon)</label>
    <input id="coupon">

    <label>Base Price (‚Çπ)</label><input id="baseprice" type="number">
    <label>Discount Applied (‚Çπ)</label><input id="discount" readonly>
    <label>Amount Paid (‚Çπ)</label><input id="amountpaid" readonly>
    <label>Rest on Delivery (‚Çπ)</label><input id="restamount" readonly>

    <div class="summary" id="snapshot">Base ‚Çπ0
Add-on ‚Çπ0
Total ‚Çπ0
COD Charges ‚Çπ0
Advance (if COD) ‚Çπ0
Rest (if COD) ‚Çπ0</div>
  </div>
</main>

<div class="actions">
  <div class="actions-inner">
    <button class="btn-pay" onclick="payNow()">Pay Now</button>
    <button class="btn-send" id="orderBtn" onclick="sendOrder()">Submit Order Now</button>
  </div>
</div>

<script>
const el=id=>document.getElementById(id);
let globalDistance="N/A", globalETA="N/A", globalEstimatedDate="N/A";

/* --- Rules --- 
   Total = Base + Add-on
   COD not allowed <= 1300
   COD charges: 99 if Total <=1999 else 0
   COD advance = max(500,10% of Total)
   Coupon gpz2025 works only Prepaid, -200/-300/-500 (64/128/256+)
*/

function totalAmount(){return (parseInt(el("baseprice").value)||0)+(parseInt(el("addonAmount").value)||0);}
function codCharges(total){return total<=1999?99:0;}
function updateSummary(){
  const mode=el("paymentmode").value, total=totalAmount();
  const product=(el("product").value||"").toLowerCase(), variant=(el("variant").value||"").toLowerCase();
  const is64=/64/.test(variant), is128=/128/.test(variant), is256plus=/(256|500|1tb)/.test(variant);
  const coupon=el("coupon").value.trim().toLowerCase();

  // COD block rule
  if(total<=1300){
    el("paymentmode").value="prepaid";
    el("codEligibilityNote").innerText="‚ö† COD not available at or below ‚Çπ1,300.";
  }else{
    el("codEligibilityNote").innerText="COD: ‚Çπ99 ‚â§ 1999, Free above.";
  }

  let discount=0;
  if(coupon==="gpz2025" && mode==="prepaid"){
    if(is64) discount=200; else if(is128) discount=300; else if(is256plus) discount=500;
  }

  const codFee=(mode==="cod")?codCharges(total):0;
  const paid=(mode==="cod")?Math.max(500,Math.ceil(total*0.1)):total-discount;
  const rest=(mode==="cod")?total+codFee-paid:0;

  el("discount").value=discount;
  el("amountpaid").value=paid;
  el("restamount").value=rest;
  el("snapshot").textContent=`Base ‚Çπ${parseInt(el("baseprice").value)||0}
Add-on ‚Çπ${parseInt(el("addonAmount").value)||0}
Total ‚Çπ${total}
COD Charges ‚Çπ${codFee}
Advance (if COD) ‚Çπ${mode==="cod"?paid:0}
Rest (if COD) ‚Çπ${mode==="cod"?rest:0}`;
}

["baseprice","addonAmount","paymentmode","coupon","variant","product"].forEach(id=>{
  el(id).addEventListener("input",updateSummary);
  el(id).addEventListener("change",updateSummary);
});

function payNow(){const amt=el("amountpaid").value;if(amt)window.open(`upi://pay?pa=gamesplanet@upi&am=${amt}`);}

function sendOrder(){
  const now=new Date();
  const orderId=now.getTime();
  const gv=id=>el(id).value||"";
  const mode=gv("paymentmode"), total=totalAmount();
  const codFee=(mode==="cod")?codCharges(total):0;

  let eta=globalETA, delivery=globalEstimatedDate;
  if(mode==="cod" && /\d/.test(globalETA)){
    const nums=globalETA.match(/\d+/g).map(Number);
    eta=`${(nums[0]||0)+2}‚Äì${(nums[1]||nums[0])+3} days`;
  }

  const addonLine=gv("addonName")?`Add-on: ${gv("addonName")} ‚Äî ‚Çπ${gv("addonAmount")}`:"Add-on: None";

  let msg="";
  if(mode==="prepaid"){
    msg=`üü¢ Prepaid Order on WhatsApp

Order ID: ${orderId}
Name: ${gv("name")}
Mobile: ${gv("mobile")}
Alt Mobile: ${gv("altmobile")}
Email: ${gv("email")}
Address: ${gv("address")}
Landmark: ${gv("landmark")}
Pincode: ${gv("pincode")}
State: ${gv("state")}
District/City: ${gv("city")}
Post office: ${gv("postoffice")}
Product: ${gv("product")}
Variant: ${gv("variant")}
${addonLine}
Base Price: ‚Çπ${gv("baseprice")}
Discount Applied: ‚Çπ${gv("discount")}
Amount Paid: ‚Çπ${gv("amountpaid")}

üìè Distance: ${globalDistance}
‚è≥ Prepaid Order ETA: ${eta}
üìÖ Estimated Delivery: ${delivery}
Delivery Circumstances and conditions:`;
  } else {
    msg=`üî¥ COD Order on WhatsApp

Order ID: ${orderId}
Name: ${gv("name")}
Mobile: ${gv("mobile")}
Alt Mobile: ${gv("altmobile")}
Email: ${gv("email")}
Address: ${gv("address")}
Landmark: ${gv("landmark")}
Pincode: ${gv("pincode")}
State: ${gv("state")}
District/City: ${gv("city")}
Post office: ${gv("postoffice")}
Product: ${gv("product")}
Variant: ${gv("variant")}
${addonLine}
Base Price: ‚Çπ${gv("baseprice")}
Discount Applied: ‚Çπ${gv("discount")}
Amount Paid: ‚Çπ${gv("amountpaid")}
Rest on Delivery: ‚Çπ${gv("restamount")}

üìè Distance: ${globalDistance}
‚è≥ COD Order ETA: ${eta}
üìÖ Estimated Delivery: ${delivery}
Delivery Circumstances and conditions:`;
  }
  location.href=`https://wa.me/917983624797?text=${encodeURIComponent(msg)}`;
}
updateSummary();
</script>
</body>
</html>
